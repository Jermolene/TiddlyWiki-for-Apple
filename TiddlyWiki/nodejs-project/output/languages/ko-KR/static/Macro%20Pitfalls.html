<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.3.2-prerelease" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>Macro Pitfalls: 티들리위키 — 줄 없는 개인 웹 공책</title>
</head>
<body class="tc-body">
<p><div class="tc-static-alert"><div class="tc-static-alert-inner">이 문서는 <a class="tc-tiddlylink-external" href="https://tiddlywiki.com/languages/ko-KR/" rel="noopener noreferrer" target="_blank">https://tiddlywiki.com/languages/ko-KR/</a>에서 티들리위키의 정적 HTML 표현의 일부입니다</div></div>
</p>
<section class="tc-story-river tc-static-story-river">
<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists " data-tags="" data-tiddler-title="Macro Pitfalls" role="article"><div class="tc-tiddler-title">
<div class="tc-titlebar">
<span class="tc-tiddler-controls">
<span class=" tc-reveal"><button aria-expanded="false" aria-label="더 보기" class="tc-btn-invisible" title="더 많은 동작을 봅니다"></button><div class=" tc-reveal" hidden="true"></div></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal"><button aria-label="편집" class="tc-btn-invisible" title="이 티들러를 편집합니다"></button></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal"><button aria-label="닫기" class="tc-btn-invisible" title="이 티들러를 닫습니다"></button></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span>
</span>

<span>

<span class="tc-tiddler-title-icon" style="fill:;">

</span>



<h2 class="tc-title">

Macro Pitfalls

</h2>

</span>

</div>

<div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div>
</div><div class="tc-reveal"></div><div class=" tc-reveal"><div class="tc-subtitle"><a class="tc-tiddlylink tc-tiddlylink-missing" href=".html"></a> 2023년 4월 19일 오전 11:31</div></div><div class=" tc-reveal"><div class="tc-tags-wrapper"></div></div>






<div class="tc-tiddler-body tc-reveal"><h1 class="">Introduction</h1><p>In the early days of <a class="tc-tiddlylink tc-tiddlylink-resolves" href="TiddlyWiki.html">TiddlyWiki</a>, <a class="tc-tiddlylink tc-tiddlylink-resolves" href="Macros.html">macros</a> were the best way of encapsulating snippets for reuse, and so they were used extensively. However, they have always suffered from some significant disadvantages that can give rise to errors and poor performance.</p><p><a class="tc-tiddlylink tc-tiddlylink-resolves doc-from-version" href="Release%25205.3.0.html"><svg class="tc-image-warning tc-image-button" height="22pt" viewBox="0 0 128 128" width="22pt"><path d="M57.072 11c3.079-5.333 10.777-5.333 13.856 0l55.426 96c3.079 5.333-.77 12-6.928 12H8.574c-6.158 0-10.007-6.667-6.928-12l55.426-96zM64 37c-4.418 0-8 3.582-8 7.994v28.012C56 77.421 59.59 81 64 81c4.418 0 8-3.582 8-7.994V44.994C72 40.579 68.41 37 64 37zm0 67a8 8 0 100-16 8 8 0 000 16z" fill-rule="evenodd"></path></svg> New in: 5.3.0</a> Macros have been joined by <a class="tc-tiddlylink tc-tiddlylink-resolves" href="Procedures.html">Procedures</a>, <a class="tc-tiddlylink tc-tiddlylink-resolves" href="Custom%2520Widgets.html">Custom Widgets</a> and <a class="tc-tiddlylink tc-tiddlylink-resolves" href="Functions.html">Functions</a> which together provide more robust and flexible ways to encapsulate and re-use code. It is now recommended to only use macros when textual substitution is specifically required.</p><h1 class="">Shortcomings of Textual Substitution</h1><p><a class="tc-tiddlylink tc-tiddlylink-resolves" href="TiddlyWiki.html">TiddlyWiki</a>'s handling of <a class="tc-tiddlylink tc-tiddlylink-resolves" href="Macros.html">macro</a> parameters is based on "textual substitution" which means that the string values of the parameters provided when calling a macro are plugged into the macro definition before it is wikified.</p><p>Here's a typical example of the approach in early versions of <a class="tc-tiddlylink tc-tiddlylink-resolves" href="TiddlyWiki.html">TiddlyWiki</a> 5. The intention is to provide a macro that takes a single parameter of the title of the tiddler to view:</p><pre><code>\define mymacro(title)
&lt;$codeblock code={{$title$}}/&gt;
\end</code></pre><p>That works for simple cases like <code>&lt;&lt;mymacro "HelloThere"&gt;&gt;</code> but is subtly brittle.  For example, the macro above would fail with tiddler titles containing double closing curly braces. Trying to use it with the title <code>foo}}bar</code> would lead to the macro being expanded to the following invalid syntax:</p><pre><code>&lt;$codeblock code={{foo}}bar}}/&gt;</code></pre><p>As a result of this issue, for many years  the <a class="tc-tiddlylink tc-tiddlylink-resolves" href="TiddlyWiki.html">TiddlyWiki</a> 5 user interface failed if a variety of combinations of special characters were encountered in tiddler titles.</p><p>This issue has been mitigated over the years, particularly by providing access to the macro parameters as variables. However, for backwards compatibility, this was done without affecting the existing syntax, which required us to adopt the clumsy protocol of wrapping the parameter name in double underscores to get the name of the corresponding variable.</p><h1 class="">Performance of Global Macros</h1><p>Global <a class="tc-tiddlylink tc-tiddlylink-resolves" href="Macro%2520Definitions.html">Macro Definitions</a> defined with the <a class="tc-tiddlylink tc-tiddlylink-resolves" href="SystemTag%253A%2520%2524%253A%252Ftags%252FMacro.html">SystemTag: $:/tags/Macro</a> suffer from poor performance because every macro has to be parsed regardless of whether it is actually used.</p><p>Furthermore, the way that definitions are imported means that updating a tiddler tagged <a class="tc-tiddlylink tc-tiddlylink-resolves" href="SystemTag%253A%2520%2524%253A%252Ftags%252FMacro.html">SystemTag: $:/tags/Macro</a> will cause the entire page to be refreshed.</p></div>

</div></p>
</section>
</body>
</html>

